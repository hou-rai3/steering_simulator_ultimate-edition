# ステアリングシミュレーター Ultimate Edition

PID制御を用いた高度な車両操舵シミュレーションシステム

---

## 概要

PID制御の使ったロボットの操舵シミュレーションです。`pygame`による描画と`PySide6`によるGUIを組み合わせ、リアルタイムでPIDパラメータを調整しながら車両制御のゲームができます。

### 主な特徴
- **リアルタイムPIDチューニング**: 6つのPIDパラメータを動的に調整
- **マルチプロセス設計**: GUIとシミュレーションが独立して動作
- **直感的な操作**: マウスによる目標位置設定
- **視覚的フィードバック**: 車両の動きと制御状態をリアルタイム表示

---

## システム構成

### 1. GUIプロセス (`run_gui`)
`PySide6.QtWidgets`ベースの制御パネル
- 6つのスライダーによるPIDゲイン調整
- リアルタイムパラメータ更新
- 現在値の数値表示

### 2. シミュレーションプロセス (`run_simulation`)
`pygame`ベースのシミュレーションエンジン
- 車両物理演算
- PID制御アルゴリズム実装
- マウス入力による目標位置設定
- リアルタイム描画

### プロセス間通信
`multiprocessing.Manager().dict()`による共有メモリを使用し、両プロセス間でPIDパラメータをリアルタイム同期

---

## PID制御システム

### 制御方式
本システムでは2つの独立したPID制御ループを実装：

#### 1. 角度制御ループ
車両の向きを目標方向に制御

```
PID出力 = Kp_angle × 角度誤差 + Ki_angle × ∫角度誤差dt + Kd_angle × d(角度誤差)/dt
```

- **比例項(P)**: 現在の角度誤差に比例した制御
- **積分項(I)**: 長期的な角度偏差の補正
- **微分項(D)**: 角度変化の急激な変動を抑制

#### 2. 速度制御ループ
車両の速度を目標速度に制御

```
PID出力 = Kp_speed × 速度誤差 + Ki_speed × ∫速度誤差dt + Kd_speed × d(速度誤差)/dt
```

- **比例項(P)**: 現在の速度誤差に比例した制御
- **積分項(I)**: 定常偏差の除去
- **微分項(D)**: 速度変化のオーバーシュート抑制

---

## GUI制御パネル

### PIDパラメータ調整
6つのスライダーによる精密制御：

#### 角度制御系
- **KP Angle**: 角度制御の比例ゲイン (0.0-10.0)
- **KI Angle**: 角度制御の積分ゲイン (0.0-5.0)
- **KD Angle**: 角度制御の微分ゲイン (0.0-5.0)

#### 速度制御系
- **KP Speed**: 速度制御の比例ゲイン (0.0-10.0)
- **KI Speed**: 速度制御の積分ゲイン (0.0-5.0)
- **KD Speed**: 速度制御の微分ゲイン (0.0-5.0)

### リアルタイム更新
スライダー操作により`shared_data`が即座に更新され、シミュレーションに反映されます。

---

## 使用方法

1. **システム起動**: メインスクリプトを実行
2. **目標設定**: マウスカーソルで目標位置を指定
3. **パラメータ調整**: GUIスライダーでPIDゲインを調整
4. **動作観察**: 車両の応答特性を確認

---

## 技術仕様

- **Python 3.8+**
- **pygame**: シミュレーション描画
- **PySide6**: GUI framework
- **multiprocessing**: プロセス間通信
- **数値計算**: NumPy互換の数学演算

---

## 学習効果

本シミュレーターを通じて以下の制御理論を実践的に学習できます：

- PID制御の基本原理
- 各ゲインが系の応答に与える影響
- 制御系のチューニング手法
- マルチループ制御システムの設計

---